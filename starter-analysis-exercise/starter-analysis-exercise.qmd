---
title: "Future Exercise"
---

```{r package}
# add package
library("dslabs")
library(dplyr)
```

```{r}
# load data
str(gapminder)

# summary of data
summary(gapminder)

# check type of data
class(gapminder)
```

```{r}
# creat aficadata
africadata <- gapminder[gapminder$continent == "Africa", ]

# check 
str(africadata)

# sum
summary(africadata)
```

```{r}
#create two object
af_mort_life <- africadata[,c("infant_mortality","life_expectancy")]
af_pop_life <- africadata[,c("population","life_expectancy")]

# check
str(af_mort_life)
summary(af_mort_life)

# check pop and life 
str(af_pop_life)
summary(af_pop_life)
```

```{r plot}
# Plot : Africa:Life expectancy vs infant mortality
plot(
    x = af_mort_life$infant_mortalit,
    y = af_mort_life$life_expectancy,
    xlab = "Infant mortality",
    ylab = "Life expectancy",
    pch = 16,
    main = "Africa: Life expectancy vs infant mortality"
)
```

The plot shows a clear negative relationship between infant mortality and life expectancy. Countries and years with higher infant mortality tend to have lower life expectancy.

```{r}
# Plot life expectancy vs population
plot(
    x = af_pop_life$population,
    y = af_pop_life$life_expectancy,
    xlab = "Population (log scale)",
    ylab = "Life expectancy",
    pch = 16,
    main = "Africa: Life expectancy vs population",
    log = "x" 
)
```

In this plot, we can see distinct ‘streaks’ of data. When examining each streak separately, both population size and life expectancy appear to increase together. From the data, we can know these streaks represent repeated observations of the same country across different years. Over time, countries tend to experience population growth along with improvements in life expectancy.

```{r}
# find the year with missing data
africadata %>% 
  filter(is.na(infant_mortality)) %>% 
  count(year)
```

From 1960 to 1981 and in 2016, there were missing values in the data.

```{r}
# choose year = 2000 in Africa data
af_2000 <- africadata[africadata$year == 2000, ]

# check 
str(af_2000)
summary(af_2000)
```

```{r}
# Create Plot in 2000
# Plot: life expectancy vs infant mortality (2000)
plot(
  x = af_2000$infant_mortality,
  y = af_2000$life_expectancy,
  xlab = "Infant mortality",
  ylab = "Life expectancy",
  pch = 16,
  main = "Africa 2000: Life expectancy vs Infant Mortality"
)

# Plot: life expectancy vs population (2000)
plot(
  x = af_2000$infant_mortality,
  y = af_2000$life_expectancy,
  xlab = "Population (log scale)",
  ylab = "Life expectancy",
  pch = 16,
  main = "Africa 2000: Life expectancy vs Population",
  log = "x"
)
```

When restricting the data to the 2000 year, It seems like there are still the negative relationship bewteen infant mortality and life expectancy in the first graph. However, we can't find the streaks observed earlier. There is no clear association between population size and life expectancy within the year 2000.

```{r reg}
# Fit a linear model 
# linear model life_expectancy vs infant_mortality 
fit1 <- lm(life_expectancy ~ infant_mortality, data = af_2000)

# display summary about fit1
summary(fit1)

# linear model life_expectancy vs population
fit2 <- lm(life_expectancy ~ population, data = af_2000) 

# display summary about fit2
summary(fit2)
```

From the result in fit1, in 2000, the infant mortality rate in African countries was significantly negatively correlated with life expectancy (p < 0.001). For every 1 unit increase in the infant mortality rate, the life expectancy was expected to decrease by approximately 0.19 years. 
From the result in fit2, in 2000, there was no significant correlation between the population size of African countries and their life expectancy (p = 0.616). Changes in population size were unable to effectively predict the level of life expectancy in these countries. In contrast, infant mortality rate was a more crucial predictive factor.